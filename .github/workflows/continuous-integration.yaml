name: Continuous Integration

on:
  push:
    branches:
    - master
  pull_request:
    branches:
    - master

jobs:
  build:
  runs-on: ubuntu-latest
  strategy:
    matrix:
      node-version: [10, 12, 14]

  steps:
     - name: Git checkout
      uses: actions/checkout@v1

    - name: Use Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v1
      with:
        node-version: ${{ matrix.node-version }}

    - name: Cassandra Setup
      - uses: fabasoad/setup-cassandra-action@v1.0.0
        with:
          host: 'localhost'
          port: 9042
          connect-timeout: 30
          keyspace: test
          scripts_path: './test/init.js'
    - run: npm install
    - run: npm test
      env:
        CI: true